<!DOCTYPE html>
<html>

   <head>
      <meta charset = "UTF-8">
      <title>Annotation</title>
      <link rel="stylesheet" href="./style/ann_menu.css">
   </head>

   <body>
      <div id="entete">
         <a id="top" href="../index.html"> Home </a>
         <a id="top" href="./about.html">About </a>
         <a id="top" href="./tutorial.html">Tutorials</a>

      </div>
      <div id="main">
         <div id="menu">
            <button id="WriteBtn" type="button" class="btn">Ecrire mon texte</button>
            <button id="AddtxtBtn" type="button" class="btn">Importer texte</button>
            <button id="AnnoterBtn" type="button" class="btn">Annoter tout le texte</button>
            <button id="AnnoterPartBtn" type="button" class="btn" onclick="GetSelectedText()">Annoter</button>
            <button id="clearBtn" type="button" class="btn">Effacer</button>
            <button id="Refresh" type="button" class="btn">Reprendre l'ancien travail</button>
            <button id="DownloadBtn" type="button" class="btn">Télécharger JSON</button>
         </div>
         <div id="contenu">
            <div class = "test" id="Inputtxt">

            </div>
            <div class = "test" id="annotation">
               <div class = "search" id="ent">
                 Annotations
               </div>
               <div class = "search" id="ann-list">
                  <ul class="annotation-list" id="annList">
                     
                  </ul>
               </div>

            </div>
        </div>

      </div>
      <script src = "./menu.js"></script>
      <script  src="./ann_menu.js"> </script>
   </body>
</html>

<script text="javascript">

   function changeClass(elem){
      if (elem.className == 'input-txt'){
         elem.className = "input-txt-toggle";
         var elt = elem.textContent;
         ipcRenderer.send('annotate-object',elt);
      }
      else{
         elem.className = 'input-txt';
      }
   }

   function GetSelectedText(){

      var selectedText = '';
      var range = [];

      let element = document.createElement("mark")

      if (window.getSelection) {
         selectedText = window.getSelection();
         range.push(selectedText.getRangeAt(0).startOffset,selectedText.getRangeAt(0).endOffset) ;
         var rangeToSelect = document.createRange();
         rangeToSelect.selectNode(selectedText.anchorNode);
         var objectText = rangeToSelect.toString();
         window.getSelection().getRangeAt(0).surroundContents(element);
      }

      var textSelected = selectedText.toString();
      console.log(ipcRenderer.send('text-selection', textSelected,range,objectText ))
   }

</script>
